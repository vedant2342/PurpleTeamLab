name: Detection Engineering Pipeline

on:
  push:
    branches:
      - main
  workflow_dispatch:

  pull_request:

jobs:
  detection-pipeline:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Install dependencies
      run: |
        sudo apt update
        sudo apt install -y bash powershell

    - name: Set execute permissions
      run: |
        chmod +x simulations/linux/run_simulation.sh || true
        chmod +x validation/run_pipeline.sh || true
        chmod +x validation/linux/test_detections.sh || true

    - name: Run Unified Detection Pipeline (Linux + Windows)
      run: |
        cd validation
        ./run_pipeline.sh

